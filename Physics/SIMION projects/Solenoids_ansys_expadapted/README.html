<html>
<head>
<title>SIMION Field (Magnetic or Gas) Data Import Examples</title>

<style type="text/css">
  body { font-family: verdana, arial, sans-serif; font-size: 90%; }
  .copyright {font-size:80%; border-top:1px solid black}
  .title1 {background-color:#80ff80}
  .links1 {background-color:#c0ffc0}
  .content {max-width:30em; margin-left:5px; margin-right:5px }
  h1 {margin-top: 0; margin-bottom: 0; background-color:#e0ffe0; font-size:130%}
  h2 {font-size:120%}
  h3 {font-size:110%}
  h4, h5, h6 {font-size:100%}
</style>
</head>

<body  marginwidth="0" marginheight="0" leftmargin="0" topmargin="0" rightmargin="0" bottommargin="0">
<div class="title1">
<a href="../_redirect.html?id=index">SIMION&reg; 2020</a>
</div>
<h1>SIMION Field (Magnetic or Gas) Data Import Examples</h1>
<div class="content">



<h2>Purpose</h2>

<p>
This is an example of loading a 2D or 3D grid of magnetic field
vectors or gas flow data as an ASCII text file and applying it into a workbench.  The
field is interpolated between grid points.
Examples are included of importing from various third-party programs.
</p>

<p>
A few ways of doing this are illustrated.
The old SIMION 8.0 way, as demonstrated in field_array.iob,
is to use the simion.FieldArray library.
The newer SIMION 8.1 way, as demonstrated in solenoid_pa.iob,
is to store the x, y, and z components of the magnetic field vectors in regular
SIMION PA files, which can be Modified and Viewed like other PA's.
A even newer version (field_array_x.iob) is similar to the previous
example but uses the more complete simion.experimental.field_array library,
which requires early access mode (8.2).
</p>

<h2>Files in this demo:</h2>

<ul>
<li>README.html - Description of example
<li>solenoid_pa.iob - SIMION workbench illustrating using PA objects to store magnetic field.
  <ul>
  <li>solenoid-bx.pa, solenoid-by.pa, solenoid-bz.pa - PA objects holding x, y, and z components of
    the magnetic field vectors.
  </li>
  <li>solenoid_pa.fly2 - particle definitions
  <li>solenoid_pa.lua - workbench user program that interprets PA objects as magnetic field.
  <li>fieldlib.lua - utility library
  </ul>
<li>field_array_x.iob - SIMION workbench illustrating FieldArray library.
  This is a newer version of solenoid_pa.iob but uses the newer
  simion.experimental.field_array library, which requires early access mode (8.2).
  <ul>
  <li>field_array_x.fly2 - particle definitions
  <li>field_array_x.lua - workbench user program that interprets PA objects as magnetic field.
  </ul>
<li>field_array.iob - SIMION workbench illustrating FieldArray library (from SIMION 8.0)
  <ul>
  <li>field_array.fly2 - SIMION particle definitions associated with field_array.iob
  <li>mag.pa - Blank magnetic PA.  Used to contain solenoid magnetic field.
         Used in field_array.iob.
  <li>field_array.lua - SIMION workbench user program used to apply
        magnetic field from solenoid.csv into the field_array.iob workbench.
  <li>solenoid.csv - magnetic field data grid.
  <li>makefile.lua - SIMION batch mode program used to calculate solenoid.csv
        (this was already run and is only used to generate the example data)
  </ul>
<li>cfd.iob - similar to field_array_x.iob but more specifically loads PA's with gas flow data
  <ul>
  <li>flow_t.pa, flow_vx.pa, flow_vy.pa - gas flow PA's, used by cfd.iob/lua
    and generated by cfd_make_arrays.lua.
  </ul>
<li>Field import from other programs
  <ul>
  <li>fluent_ip_to_pa.lua - convert gas flow in Fluent .ip file to SIMION PA's.
  <li>fluent_example.ip - trivial example Fluent .ip file used by fluent_ip_to_pa.lua
  <li>ansys_to_pa.lua - convert ANSYS gas flow (ansys.dat) to SIMION PA's.
  <li>comsol_to_pa.lua - convert COMSOL gas flow files
     (comsol_vx.txt and comsol_vy.txt) to SIMION PA's (8.2 EA)
  <li>opera_to_pa.lua - convert Opera-3D B-field file
     (opera.table) to SIMION PA's (8.2 EA)
  <li>ds2v_to_pa.m - Matlab/Octave program to read DS2V program output,
    resample onto a rectilinear grid (using the griddata function) and write a SIMION PA file.
    Uses ds2ff.dat - DS2V program output example.  Requires ../matlab/simion_pa_save.m.  (8.2 EA)
  <li>solidworks_to_pa.lua - convert SolidWorks gas flow output file (solidworks.txt) to SIMION PA files.
  <li>Note: see the "See Also" for other programs like SuperFish and QuickField.
  </ul>
</ul>

<h2>Usage</h2>

<p>How to run the solenoid_pa.iob example:</p>

<ul>
<li>1. <b>View solenoid_pa.iob</b>
      <i>(Click View on main screen and select the solenoid_pa.iob file.)</i>
<li>3.  <b>Fly ions.</b>
        <i>(Click Fly'm.)</i>
        Notice that the ions are focused through the cylindrical region
        (which is inside the solenoid).
        When the particle is in a region greater than 9 Gauss, the
        trajectory is drawn green (for display purposes).
        In fact, the results are near identical to the SIMION
        "solenoid" example.
        Field vectors are also drawn.
</ul>

<p>See the solenoid_pa.lua file for details.</p>

<p>Note: the field_array_x.iob example can be run similarly but uses a newer
<a href="../_redirect.html?id=lua_simion.experimental.field_array">simion.experimental.field_array</a>
library rather than the fieldlib.lua.

<p>Usage of field_array.iob:</p>

<ul>
<li>1.  <b>View field_array.iob.</b>
        <i>(Click View on main screen and select the field_array.iob file.)</i>
<li>2.  If this is your first time using the example,
        you will be <b>asked to refine</b> <i>(confirm that
        and press Refine)</i>.
<li>3.  <b>Fly ions.</b>
        <i>(Click Fly'm.)</i>
        Notice that the ions are focused through the cylindrical region
        (which is inside the solenoid).
        When the particle is in a region greater than 9 Gauss, the
        trajectory is drawn green (for display purposes).
        In fact, the results are near identical to the SIMION
        "solenoid" example.
</ul>

<p>See the mfield_array.lua source code for more details.</p>

<p>Usage of cfd.iob</p>

<p>This example is similar to field_array_x.iob but more specifically loads PA's with gas flow data.
The flow_t.pa, flow_vx.pa, flow_vy.pa  are gas flow PA's used by cfd.iob (cfd.lua)
and generated by cfd_make_arrays.lua (which you don't have to run because this has already
been run for you).
</p>

<p>Usage of fluent_ip_to_pa.lua:</p>

<p>
This is an example of converting a gas flow computed by Fluent into
SIMION PA format.
See <a href="../_redirect.html?id=cfd">Doc(CFD)</a>
for background.
The "fluent_ip_to_pa.lua" can be run from the "Run Lua Program"
button on the SIMION main screen.
However, you should first edit this file according to your needs though.
</p>

<p>Usage of comsol_to_pa.lua (version 8.2 early access):</p>

<p>
This is an example of converting a gas flow computed by COMSOL&reg; into
SIMION PA format.
See <a href="../_redirect.html?id=cfd">Doc(CFD)</a>
for background.
The "comsol_to_pa.lua" can be run from the "Run Lua Program"
button on the SIMION main screen.
However, you should first edit this file according to your needs though.
COMSOL&reg; is a registered trademark of COMSOL AB.
</p>

<p>Usage of ds2v_to_pa.m</p>

<p>
This ds2v_to_pa.m program is designed to be run in Matlab or Octave.
It reads the ds2ff.dat file outputted by the DS2V program and writes
SIMION PA files for each scalar field.
The dsf2ff.dat file 
It requires the  ../matlab/simion_pa_save.m file.
See comments in ds2v_to_pa.m for details.
</p>

<p>Usage of opera_to_pa.lua</p>

<p>
This opera_to_pa.lua program converta an Opera-3D B-field file
(opera.table) to SIMION PA's (8.2 EA), writing each component of the B-field
vector as a separate PA.
It can be run from the Run Lua Program button on the SIMION main screen.
See comments in opera_to_pa.lua for details.
</p>

<p>Usage of solidworks_to_pa.lua</p>

<p>
This solidworks_to_pa.lua program converts a SolidWorks gas flow output file
(solidworks.txt) to SIMION PA files, writing each scalar field to a separate PA file.
It can be run from the Run Lua Program button on the SIMION main screen.
See comments in solidworks_to_pa.lua for details.
</p>

<p>Usage of ansys_to_pa.lua</p>

<p>
This ansys_to_pa.lua program converts ANSYS gas flow (ansys.dat) to SIMION PA's,
writing each scalar field to a separate PA file.
It can be run from the Run Lua Program button on the SIMION main screen.
See comments in ansys_to_pa.lua for details.
</p>

<h2>See Also</h2>

<ul>
<li><a href="../poisson_superfish/README.html">Example: Poisson Superfish</a> - importing from Poisson Superfish.
<li><a href="../quickfield/README.html">Example: QuickField</a> - importing fields from QuickField
<li><a href="../magnet/README.html">Example: Magnet</a>.
<li><a href="../field/README.html">Example: Field</a>, which re-expresses magnetic field vectors in terms of scalar
potential and sets those potentials in a magnetic field PA.
<li><a href="../_redirect.html?id=lua_simion.pas">Doc(simion.pas) API</a>
<li><a href="../_redirect.html?id=lua_simion.experimental.field_array">Doc(simion.experimental.field_array)
  API (early access 8.2)</a>
</ul>

<h2>Changes/History</h2>

<ul>
<li>2017-04-20: add Opera-3D example: opera_to_pa.lua and opera.table.
<li>2017-04-20: add ANSYS example: ansys_to_pa.lua and ansys.dat
<li>2017-04-20: add DS2V example: ds2v_to_pa.m and ds2ff.dat
<li>2017-04-20: refactor SolidWorks example some and add data file example.
<li>2017-04-20: add cfd.iob example.
<li>2017-04-20: shorten names of some Lua programs.
<li>2017-01-14: fieldlib.lua: make_field support scalar fields too.
<li>2017-01-13: moved fluent*, comsol* examples into this folder.
  <ul>
  <li>2015-10-26: fluent_to_ip_simion_pas.lua: add support for Fluent version 3 IP files.
  <li>2013-05-20: Added comsol_to_simion_pas.lua.
  Basic example files included
  (comsol_vx.txt and comsol_vy.txt reproduced by permission of Tianpeng).
  <li>2012-07-16: fluent_ip_to_simion_pas.lua: Export gas flow units as m/s (not mm/usec)
  as expected by SDS model.
  <li>2012-03: Add Fluent example.
  </ul>
<li>2014-03-14: Added field_array_x.iob sub-example, illustrating use of the
  simion.experimental.field_array library.
<li>2012-03 - Added solenoid_pa.iob sub-example.
<li>D.Manura-2007-03.
</ul>

</div>
    
<div class="copyright">SIMION&reg; 2020 (c) 2003-2020 Scientific
Instrument Services, Inc. All Rights Reserved.
</div>
    </body></html>
